<!DOCTYPE html>


  <html class="light page-post">


<head>
  <meta charset="utf-8">
  
  <title>iOS开发Tips | Hexo</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
    <meta name="keywords" content="forsigner,前端,设计,Hexo主题,前端开发,用户体验,设计,frontend,design,nodejs,JavaScript" />
  

  <meta name="description" content="1. 使用字面量语法Objective-C中，可以用字面量语法生成和使用对象，这样能节省不少代码： NSString* str = @&amp;quot;string&amp;quot;;  //使用@&amp;quot;&amp;quot;生成NSString  NSNumber* num = @30; //使用@num生成NSNumber，注意，num必须是常数，不能是变量  //使用@()将变量转化为NSNumber in">
<meta property="og:type" content="article">
<meta property="og:title" content="iOS开发Tips">
<meta property="og:url" content="http://yoursite.com/2014/12/08/iOS开发Tips/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="1. 使用字面量语法Objective-C中，可以用字面量语法生成和使用对象，这样能节省不少代码： NSString* str = @&amp;quot;string&amp;quot;;  //使用@&amp;quot;&amp;quot;生成NSString  NSNumber* num = @30; //使用@num生成NSNumber，注意，num必须是常数，不能是变量  //使用@()将变量转化为NSNumber in">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2015-10-31T16:08:45.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="iOS开发Tips">
<meta name="twitter:description" content="1. 使用字面量语法Objective-C中，可以用字面量语法生成和使用对象，这样能节省不少代码： NSString* str = @&amp;quot;string&amp;quot;;  //使用@&amp;quot;&amp;quot;生成NSString  NSNumber* num = @30; //使用@num生成NSNumber，注意，num必须是常数，不能是变量  //使用@()将变量转化为NSNumber in">

  

  
    <link rel="icon" href="/favicon.ico">
  

  <link href="/css/styles.css?v=c114cben" rel="stylesheet">


  
    <link rel="stylesheet" href="/css/personal-style.css">
  

  

  
  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?57e94d016e201fba3603a8a2b0263af0";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>


  
  <script type="text/javascript">
	(function(){
	    var bp = document.createElement('script');
	    var curProtocol = window.location.protocol.split(':')[0];
	    if (curProtocol === 'https') {
	        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
	    }
	    else {
	        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
	    }
	    var s = document.getElementsByTagName("script")[0];
	    s.parentNode.insertBefore(bp, s);
	})();
  </script>



  
    <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  

  
    <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.3.0/css/font-awesome.min.css">
  
</head>

<body>


  
    <span id="toolbox-mobile" class="toolbox-mobile">盒子</span>
  

  <div class="post-header CENTER">
   
  <div class="toolbox">
    <a class="toolbox-entry" href="/">
      <span class="toolbox-entry-text">盒子</span>
      <i class="icon-angle-down"></i>
      <i class="icon-home"></i>
    </a>
    <ul class="list-toolbox">
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/archives/"
            rel="noopener noreferrer"
            target="_self"
            >
            博客
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/category/"
            rel="noopener noreferrer"
            target="_self"
            >
            分类
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/tag/"
            rel="noopener noreferrer"
            target="_self"
            >
            标签
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/link/"
            rel="noopener noreferrer"
            target="_self"
            >
            友链
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/about/"
            rel="noopener noreferrer"
            target="_self"
            >
            关于
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/atom.xml"
            rel="noopener noreferrer"
            target="_blank"
            >
            RSS
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/search/"
            rel="noopener noreferrer"
            target="_self"
            >
            搜索
          </a>
        </li>
      
    </ul>
  </div>


</div>


  <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    <ol class="toc"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-使用字面量语法"><span class="toc-text">1. 使用字面量语法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-使用runTime打印description"><span class="toc-text">2. 使用runTime打印description</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-使用po-view-recursiveDescription查看UIView层级"><span class="toc-text">3. 使用po view.recursiveDescription查看UIView层级</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-对不再调用的方法使用DEPRECATED-ATTRIBUTE"><span class="toc-text">4. 对不再调用的方法使用DEPRECATED_ATTRIBUTE</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-使用映射代替Switch和if-else"><span class="toc-text">5. 使用映射代替Switch和if-else</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#6-使用return简化if-else"><span class="toc-text">6. 使用return简化if-else</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#7-使用动态方案解决"><span class="toc-text">7. 使用动态方案解决</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-super使用要慎重"><span class="toc-text">8. super使用要慎重</span></a>
  </div>



<div class="content content-post CENTER">
   <article id="post-iOS开发Tips" class="article article-type-post" itemprop="blogPost">
  <header class="article-header">
    <h1 class="post-title">iOS开发Tips</h1>

    <div class="article-meta">
      <span>
        <i class="icon-calendar"></i>
        <span>2014.12.08</span>
      </span>

      
        <span class="article-author">
          <i class="icon-user"></i>
          <span>John Doe</span>
        </span>
      

      
  <span class="article-category">
    <i class="icon-list"></i>
    <a class="article-category-link" href="/categories/代码规范和技巧/">代码规范和技巧</a>
  </span>



      
        <span>
          <i class="icon-comment"></i>
          <a href="https://lianchengjiang.github.io/archives/2014/12/08/iOS开发Tips/#disqus_thread"></a>
        </span>
      

      
      <i class="fa fa-eye"></i> 
        <span id="busuanzi_container_page_pv">
           &nbsp热度 <span id="busuanzi_value_page_pv">
           <i class="fa fa-spinner fa-spin"></i></span>℃
        </span>
      
      
    </div>
  </header>

  <div class="article-content">
    
      <h5 id="1-使用字面量语法"><a href="#1-使用字面量语法" class="headerlink" title="1. 使用字面量语法"></a>1. 使用字面量语法</h5><p><code>Objective-C</code>中，可以用字面量语法生成和使用对象，这样能节省不少代码：</p>
<pre><code>NSString* str = @&quot;string&quot;;  //使用@&quot;&quot;生成NSString

NSNumber* num = @30; //使用@num生成NSNumber，注意，num必须是常数，不能是变量

//使用@()将变量转化为NSNumber
int iNum = 30;
NSNumber* num2 = @(iNum);

//使用@{key:value}生成NSDictionary
NSDictionary* dic = @{@&quot;key1&quot;:@&quot;value1&quot;,@&quot;key2&quot;:@&quot;value2&quot;};

NSArray* ary = @[@1,@2,@3]; //使用@[value1,value2]生成数组

NSString* value = dic[@&quot;key1&quot;]; //使用[key]获取NSDictionary中value

NSNumber* num3 = ary[0];    //使用[index]获取NSNumber中value
</code></pre><h5 id="2-使用runTime打印description"><a href="#2-使用runTime打印description" class="headerlink" title="2. 使用runTime打印description"></a>2. 使用runTime打印description</h5><p>对于<code>dataModel</code>中自定义对象，在调试时我们经常需要打印出对象下面所有<code>@property</code>。这样就需要对每个自定义对象都重写<code>description</code>方法，非常麻烦。有个简便的方法就是让所有自定义的<code>model</code>都继承<code>baseModel</code>，在<code>baseModel</code>中统一用<code>runTime</code>写一个打印所有<code>@property</code>的方法即可。</p>
<pre><code>@implementation BaseModel
- (NSString*)description
{
    NSMutableString* descrption = [NSMutableString string];
    NSUInteger count = 0;
    objc_property_t* properties = class_copyPropertyList([self class], &amp;count);
    for (int m = 0;m &lt; count ; m++) {
        objc_property_t property = properties[m];
        NSString* name = [[NSString alloc]initWithCString:property_getName(property)  encoding:NSUTF8StringEncoding];

        [descrption appendFormat:@&quot;%@:%@,   &quot;,name,[self valueForKey:name]];
    }

    return descrption;
}
@end
</code></pre><h5 id="3-使用po-view-recursiveDescription查看UIView层级"><a href="#3-使用po-view-recursiveDescription查看UIView层级" class="headerlink" title="3. 使用po view.recursiveDescription查看UIView层级"></a>3. 使用<code>po view.recursiveDescription</code>查看UIView层级</h5><p>相信大多数人都明白，在iOS断点调试的时候可以通过<code>po object</code>打印出对象。</p>
<p>对于UIView的对象，有时候我们需要查看他的subView，甚至subview的subview。一个一个打印比较比较麻烦。这时候我们就可以使用<code>po view.recursiveDescription</code>打印所有view的层级。</p>
<p>对于下面的代码：</p>
<pre><code>UIView* view1 = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 100, 100)];
[self.view addSubview:view1];
UIView* view2 = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 100, 80)];
[view1 addSubview:view2];
UIButton* button = [[UIButton alloc] initWithFrame:CGRectMake(0, 50, 10, 30)];
[view2 addSubview:button];
</code></pre><p>我们可以看到<code>self.view</code>的层次关系</p>
<pre><code>(lldb) po self.view.recursiveDescription

&lt;UIView: 0x7fb5eac4da60; frame = (0 0; 320 568); autoresize = W+H; layer = &lt;CALayer: 0x7fb5eac4d800&gt;&gt;
   | &lt;UIButton: 0x7fb5eac4c380; frame = (45 20; 46 30); opaque = NO; autoresize = RM+BM; layer = &lt;CALayer: 0x7fb5eac08710&gt;&gt;
   | &lt;_UILayoutGuide: 0x7fb5eac4dd70; frame = (0 0; 0 0); hidden = YES; layer = &lt;CALayer: 0x7fb5eac4e090&gt;&gt;
   | &lt;_UILayoutGuide: 0x7fb5eac4e8c0; frame = (0 0; 0 0); hidden = YES; layer = &lt;CALayer: 0x7fb5eac204c0&gt;&gt;
   | &lt;UIView: 0x7fb5eac4b970; frame = (0 0; 100 100); layer = &lt;CALayer: 0x7fb5eac20530&gt;&gt;
   |    | &lt;UIView: 0x7fb5eac4ec60; frame = (0 0; 100 80); layer = &lt;CALayer: 0x7fb5eac20450&gt;&gt;
   |    |    | &lt;UIButton: 0x7fb5eac4bb70; frame = (0 50; 10 30); opaque = NO; layer = &lt;CALayer: 0x7fb5eac4e6a0&gt;&gt;
</code></pre><h5 id="4-对不再调用的方法使用DEPRECATED-ATTRIBUTE"><a href="#4-对不再调用的方法使用DEPRECATED-ATTRIBUTE" class="headerlink" title="4. 对不再调用的方法使用DEPRECATED_ATTRIBUTE"></a>4. 对不再调用的方法使用<code>DEPRECATED_ATTRIBUTE</code></h5><p>在代码中，如果一个方法不再使用，但是由于某些原因又不能删除，可以使用<code>DEPRECATED_ATTRIBUTE</code>标明deprecated。</p>
<pre><code>- (instancetype)initWithDictionary:(NSDictionary*)dic DEPRECATED_ATTRIBUTE;
</code></pre><h5 id="5-使用映射代替Switch和if-else"><a href="#5-使用映射代替Switch和if-else" class="headerlink" title="5. 使用映射代替Switch和if-else"></a>5. 使用映射代替<code>Switch</code>和<code>if-else</code></h5><p>在代码中，我们经常用到<code>switch</code>或者<code>if-else</code>，例如：</p>
<pre><code>switch(condition) { 
     case value1: 
         result = @&quot;valueFor1&quot;; 
     break; 
     case value2: 
         result = @&quot;valueFor2&quot;; 
     break; 
     case value3: 
         result = @&quot;valueFor3&quot;; 
     break; 
     case value4: 
         result = @&quot;valueFor4&quot;; 
     break; 
     case value5: 
         result = @&quot;valueFor5&quot;; 
     break; 
     default: 
         result = @&quot;valueForDefault&quot;; 
     break; 
 } 
 return result;
</code></pre><p>其实我们可以用字典或者数组映射来简化上面的代码：</p>
<pre><code>NSDictionary *mapping = nil; 
if(!mapping) { 
    mapping = @{ 
        @(value1) : @&quot;valueFor1&quot;, 
        @(value2) : @&quot;valueFor2&quot;, 
        @(value3) : @&quot;valueFor3&quot;, 
        @(value4) : @&quot;valueFor4&quot; 
        @(value5) : @&quot;valueFor5&quot; 
    }; 
} 
return mapping[@value] ?: @&quot;valueForDefault&quot;; 
</code></pre><p>这样做有非常明显的好处：</p>
<ol>
<li>代码量减少</li>
<li>逻辑关系清晰，阅读更方便</li>
<li>不需要<code>break</code>，不容易出错</li>
<li>可复用性高，直接拿着<code>mapping</code>就能复用</li>
</ol>
<p>这里主要是值的映射，逻辑也是同样可以映射的，假如每个<code>case</code>下面都有一些逻辑，那么可以将逻辑放在<code>block</code>中来映射，当然，如果每个<code>case</code>下代码量特别多，建议首先优化代码。<code>block</code>中如果存放的代码量特别大，也是不方便阅读的</p>
<h5 id="6-使用return简化if-else"><a href="#6-使用return简化if-else" class="headerlink" title="6. 使用return简化if-else"></a>6. 使用<code>return</code>简化<code>if-else</code></h5><p>在代码中，我们经常用到<code>if-else</code>，一般的常规用法是这样：</p>
<pre><code>if (error1) {
    //error1
}else if (error2)
{
    //error2
}else
{
    //success
}
</code></pre><p>但是实际上，我们可以这样使用：</p>
<pre><code>if (error1) {
    //error1
    return;
}
if (error2)
{
    //error2
    return;
}

//sucess
</code></pre><p>这样做的好处在于：<br>逻辑清晰，轻重分明。一般情况下，<code>error</code>里面的代码量会比较小，<code>success</code>里面的代码量会比较多，而且还可能会嵌套<code>if-else</code>，这样的好处就是将<code>sucess</code>的层数减少。逻辑清晰，并且轻的代码前面都<code>return</code>了，剩下重的代码在最后面</p>
<h5 id="7-使用动态方案解决"><a href="#7-使用动态方案解决" class="headerlink" title="7. 使用动态方案解决"></a>7. 使用动态方案解决</h5><p>有时我们可能会遇到这样的情况：</p>
<pre><code>if([type isEqualToString:@&quot;videoWidget&quot;]) { 
  [self parseVideoWidget:dictionary]; 
} else 
if([type isEqualToString:@&quot;imageWidget&quot;]) { 
  [self parseImageWidget:dictionary]; 
} else 
if([type isEqualToString:@&quot;textWidget&quot;]) { 
  [self parseTextWidget:dictionary]; 
} else 
if([type isEqualToString:@&quot;twitterWidget&quot;]) { 
  [self parseTwitterWidget:dictionary]; 
} 
</code></pre><p>对于上面这段代码，其实还有更好的解决办法：</p>
<pre><code>SEL dynamicSelector = NSSelectorFromString([NSString stringWithFormat:@&quot;parse%@:&quot;, type]); 
if(![self respondsToSelector:dynamicSelector]) { 
  DDLogWarning(@&quot;Unsupported widget type %@&quot;, type); 
  return; 
} 
[self performSelector:dynamicSelector withObject:dictionary]; 
</code></pre><p>使用动态生成SEL的方法来调用函数，这样做的好处在于：</p>
<ol>
<li>容易扩展，如果新添加一个解析方法，甚至可以不改动任何代码</li>
<li>代码量少，容易阅读并理解</li>
</ol>
<blockquote>
<p>这里的例子可能不是太明显，如果有时间，大家可以去看看<a href="https://github.com/icanzilb/JSONModel/" target="_blank" rel="noopener"><code>JSONModel</code>的源码</a>，里面对于<code>5</code>和<code>7</code>运用的非常棒，特别是第<code>7</code>条，堪称经典</p>
</blockquote>
<h4 id="8-super使用要慎重"><a href="#8-super使用要慎重" class="headerlink" title="8. super使用要慎重"></a>8. super使用要慎重</h4><p>大家使用super的时候经常会误以为这是将父类作为消息的接受者，我在使用的时候也经常这样习惯的认为，但是实际却不是这样的。<br>正常self调用方法，先从自己类开始查找这个方法，找不到再去父类查找，之后再去父类的父类查找…，一旦找到，就停止查找，然后执行方法。<br>而super是一个<code>编译器指示符</code>，他告诉编译器，跳过自己类，直接从父类开始查找。但是消息的接受者仍然是self。<br>所以会有这样的面试题，问输出结果是什么？</p>
<pre><code>@interface Son : Father
@end

@implementation Son
- (void)main{
    NSLog(@&quot;%@&quot;,[self class]);
    NSLog(@&quot;%@&quot;,[super class]);
}
@end
</code></pre><p>结果都是<code>Son</code>，原理class方法都是NSObject基类里面的，所以都能找到，接受者都是self，所以输出<code>Son</code><br>面试题毕竟只是面试用，我们很难遇到，真正会遇到的可能是这样的代码</p>
<pre><code>- (void)main{
    if ([super respondsToSelector:@selector(main)]) {
        [super main];
    }
}
</code></pre><p>这里如果父类没有实现main这个方法，就会发生crash。因为super消息接受者是self，self能响应main方法，所以if语句中条件为true，但是通过super去调用main，是找不到main方法的，所以会crash。<br>上面的例子改成这样就对了</p>
<pre><code>- (void)main{
    if ([[self superclass] instancesRespondToSelector:@selector(main)]) {
        [super main];
    }
}
</code></pre><p>so… 使用super的时候要慎重，一定要谨记消息的接受者还是self</p>

    
  </div>

</article>


   
  <div class="text-center donation">
    <div class="inner-donation">
      <span class="btn-donation">支持一下</span>
      <div class="donation-body">
        <div class="tip text-center">扫一扫，支持forsigner</div>
        <ul>
        
          <li class="item">
            
              <span>微信扫一扫</span>
            
            <img src="/images/qr-wechat.png" alt="">
          </li>
        
          <li class="item">
            
              <span>支付宝扫一扫</span>
            
            <img src="/images/qr-alipay.png" alt="">
          </li>
        
        </ul>
      </div>
    </div>
  </div>


   
  <div class="box-prev-next clearfix">
    <a class="show pull-left" href="/2014/11/01/iOS开发RunTime之函数调用/">
        <i class="icon icon-angle-left"></i>
    </a>
    <a class="show pull-right" href="/2015/01/01/JSONModel的使用/">
        <i class="icon icon-angle-right"></i>
    </a>
  </div>





   
      <div class="git"></div>
   
</div>


  <a id="backTop" class="back-top">
    <i class="icon-angle-up"></i>
  </a>




  <div class="modal" id="modal">
  <span id="cover" class="cover hide"></span>
  <div id="modal-dialog" class="modal-dialog hide-dialog">
    <div class="modal-header">
      <span id="close" class="btn-close">关闭</span>
    </div>
    <hr>
    <div class="modal-body">
      <ul class="list-toolbox">
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/archives/"
              rel="noopener noreferrer"
              target="_self"
              >
              博客
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/category/"
              rel="noopener noreferrer"
              target="_self"
              >
              分类
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/tag/"
              rel="noopener noreferrer"
              target="_self"
              >
              标签
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/link/"
              rel="noopener noreferrer"
              target="_self"
              >
              友链
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/about/"
              rel="noopener noreferrer"
              target="_self"
              >
              关于
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/atom.xml"
              rel="noopener noreferrer"
              target="_blank"
              >
              RSS
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/search/"
              rel="noopener noreferrer"
              target="_self"
              >
              搜索
            </a>
          </li>
        
      </ul>

    </div>
  </div>
</div>



  
      <div class="fexo-comments comments-post">
    
  <section class="disqus-comments">
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>
  </section>

  <script>
    var disqus_shortname = 'forsigner';
    
    var disqus_url = 'http://yoursite.com/2014/12/08/iOS开发Tips/';
    
    (function(){
      var dsq = document.createElement('script');
      dsq.type = 'text/javascript';
      dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>

  <script id="dsq-count-scr" src="//forsigner.disqus.com/count.js" async></script>



    
    

    
    

    

    
    

  </div>

  

  <script type="text/javascript">
  function loadScript(url, callback) {
    var script = document.createElement('script')
    script.type = 'text/javascript';

    if (script.readyState) { //IE
      script.onreadystatechange = function() {
        if (script.readyState == 'loaded' ||
          script.readyState == 'complete') {
          script.onreadystatechange = null;
          callback();
        }
      };
    } else { //Others
      script.onload = function() {
        callback();
      };
    }

    script.src = url;
    document.getElementsByTagName('head')[0].appendChild(script);
  }

  window.onload = function() {
    loadScript('/js/bundle.js?235683', function() {
      // load success
    });
  }
</script>

</body>
</html>
